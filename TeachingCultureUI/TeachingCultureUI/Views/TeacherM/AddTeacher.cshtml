
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <link href="~/layui/css/layui.css" rel="stylesheet" />
    <script src="~/layui/layui.js"></script>
    <title>添加教师信息</title>
</head>
<body>
    <form class="layui-form" action="" lay-filter="example" , enctype="multipart/form-data">
        <div class="layui-form-item">
            <label class="layui-form-label">所属机构</label>
            <div class="layui-input-inline">
                <select id="OrganId" name="OrganId" class="layui-select-group">
                    <option value="">请选择</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">姓名</label>
            <div class="layui-input-block">
                <input type="text" style="width:180px" name="TeacherName" id="TeacherName" lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">对外显示名称</label>
            <div class="layui-input-block">
                <input type="text" style="width:180px" name="TeacherOuter" id="TeacherOuter" lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">单选框</label>
            <div class="layui-input-block">
                <input type="radio" name="TeacherSex" value="男" title="男" checked="">
                <input type="radio" name="TeacherSex" value="女" title="女">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">学历</label>
            <div class="layui-input-inline">
                <select id="TeachereducationId" name="TeachereducationId" class="layui-select-group">
                    <option value="">请选择</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">QQ</label>
            <div class="layui-input-block">
                <input type="text" style="width:180px" name="TeacherQQ" id="TeacherQQ" lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">微信</label>
            <div class="layui-input-block">
                <input type="text" style="width:180px" name="TeacherWeChat" id="TeacherWeChat" lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">地址</label>
            <div class="layui-input-inline">
                <select id="SitesId" name="ProvinceId" class="layui-select-group">
                    <option value="">请选择省</option>
                </select>
            </div>
            <div class="layui-input-inline">
                <select id="SitesIds" name="City" class="layui-select-group">
                    <option value="">请选择市</option>
                </select>
            </div>
            <div class="layui-input-inline">
                <select id="SitesIdss" name="District" class="layui-select-group">
                    <option value="">请选择区</option>
                </select>
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">手机号</label>
            <div class="layui-input-block">
                <input type="text" style="width:180px" name="TeacherPhone" id="TeacherPhone" lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">职称</label>
            <div class="layui-input-block">
                <input type="radio" name="TeacherSex" value="教师" title="教师" checked="">
                <input type="radio" name="TeacherSex" value="助教" title="助教">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">身份证号</label>
            <div class="layui-input-block">
                <input type="text" style="width:180px" name="TeacherIDnumber" id="TeacherIDnumber" lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">毕业学校:</label>
            <div class="layui-input-block">
                <input type="text" style="width:180px" name="TeacherGraduate" id="TeacherGraduate" lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">邮箱:</label>
            <div class="layui-input-block">
                <input type="text" style="width:180px" name="TeacherCom" id="TeacherCom" lay-verify="required" autocomplete="off" class="layui-input">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">教师资格证:</label>
            <div class="layui-input-block">
                <input type="radio" name="TeacherSex" value="有" title="有" checked="">
                <input type="radio" name="TeacherSex" value="无" title="无">
            </div>
        </div>
        <div class="layui-form-item">
            <label class="layui-form-label">个人简介</label>
            <div class="layui-input-block">
                <textarea placeholder="请输入内容" name="TeacherResume" id="TeacherResume" class="layui-textarea"></textarea>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button type="submit" class="layui-btn" id="login" lay-submit="" onclick="location.href='/TeacherM/TeacherShow'">取消</button>
                <button type="button" class="layui-btn" id="btn">下一步</button>
            </div>
        </div>
    </form>
</body>
</html>
<script>
    //绑定上级机构
    layui.use(['form', 'layer', 'table'], function () {
        GetOrganName();
        GetProvinceIds();
        GetCitys();
        GetDistricts();
    });
    function GetOrganName() {
        var $ = layui.$;
        $.ajax({
            url: 'http://localhost:50111/api/GetOrganName',
            type: "get",
            dataType: 'json',
            success: function (data) {
                $(data).each(function () {
                    var str = "<option value=" + this.organId + ">" + this.organName + "</option>";
                    $("#OrganIds").append(str);
                });
                layui.form.render("select");
            }
        });
    }
    //绑定省
    function GetProvinceIds() {
        var $ = layui.$;
        $.ajax({
            url: 'http://localhost:50111/api/GetProvinceId',
            type: "get",
            dataType: 'json',
            success: function (data) {
                $(data).each(function () {
                    var str = "<option value=" + this.ProvinceId + ">" + this.SitesName + "</option>";
                    $("#SitesId").append(str);
                });
                layui.form.render("select");
            }
        });
    }
    //绑定市
    function GetCitys() {
        var $ = layui.$;
        $.ajax({
            url: 'http://localhost:50111/api/GetCity?name=' + $("#SitesId").val(),
            type: "get",
            dataType: 'json',
            success: function (data) {
                $("#SitesIds").empty();
                $("#SitesIds").append("<option>请选择</option>");
                $(data).each(function () {
                    var str = "<option value=" + this.City + ">" + this.SitesName + "</option>";
                    $("#SitesIds").append(str);
                });
                layui.form.render("select");
            }
        });
    }
    //绑定区
    function GetDistricts() {
        var $ = layui.$;
        $.ajax({
            url: 'http://localhost:50111/api/GetDistrict',
            type: "get",
            dataType: 'json',
            success: function (data) {
                $(data).each(function () {
                    var str = "<option value=" + this.District + ">" + this.SitesName + "</option>";
                    $("#SitesIdss").append(str);
                });
                layui.form.render("select");
            }
        });
    }
</script>
<script>
    layui.use(['form', 'upload', 'layer', 'table'], function () {
        var form = layui.form
            , layer = layui.layer
            , upload = layui.upload;
        var $ = layui.$;
        //监听提交
        $('#btn').on('click', function () {
            var obj = {};
            obj.OrganName = $("#OrganName").val();
            obj.OrganEncod = $("#OrganEncod").val();
            obj.PId = Number($("#OrganIds").val());
            obj.InstitutionalId = Number($("#InstitutionalIds").val());
            obj.OrganPhoneName = $("#OrganPhoneName").val();
            obj.OrganPhone = $("#OrganPhone").val();
            obj.OrganRemark = $("#OrganRemark").val();
            obj.OrganAddress = $("#OrganAddress").val();
            obj.ProvinceId = Number($("#SitesId").val());
            obj.City = Number($("#SitesIds").val());
            obj.District = Number($("#SitesIdss").val());
            //console.log(obj);
            $.ajax({
                url: "http://localhost:50111/api/AddOrganes",
                type: "post",
                contentType: 'application/json',
                data: JSON.stringify(obj),
                success:
                    function (d) {
                        if (d > 0) {
                            alert("添加成功");
                            location.href = 'OrganizationShow';
                        }
                        else {
                            layer.alert("添加失败");
                        }
                    }
            });
        });
    });

</script>